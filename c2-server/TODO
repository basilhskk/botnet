Rewrite to rust or golang 